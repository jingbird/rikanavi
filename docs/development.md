# りかナビ 開発履歴

## v1.0 - v1.9: 基本構造の構築

### v1.0: プロジェクト開始
- 基本的なHTML構造
- React + TailwindCSS導入

### v1.1-v1.3: カリキュラムデータ統合
- 教科書LODからデータ取得
- 学習指導要領LODとの統合
- 46章のデータ構造化

### v1.4-v1.6: UI実装
- 学年タブ
- 領域別表示
- 章カード

### v1.7-v1.9: 学習進捗管理
- localStorage実装
- 完了チェック機能
- 進捗率表示

---

## v1.10 - v1.13: 動画検索機能

### v1.10: NHK for School API統合
- API接続実装
- 動画リスト表示
- 再生時間表示

### v1.11: YouTube検索追加
- YouTube検索リンク
- 章タイトルベースの検索

### v1.12: Web検索追加
- Google検索リンク
- 検索クエリの最適化

### v1.13: UI改善
- 学習目標の簡潔化（24章分）
- 使い方モーダルの整理
- レイアウト調整

---

## v1.14 - v1.15: 確認テスト機能

### v1.14: 確認テスト実装
- 4択問題230問を生成（全46章×5問）
- 難易度3段階（基礎2、標準2、応用1）
- 問題データJSON化
- 採点機能実装
- 結果をlocalStorageに保存
- 章カードに点数バッジ表示

**問題生成プロセス:**
1. Claude APIで問題案を生成（環境制約により人手で実施）
2. 3つのJSONファイルに分割作成
3. 統合JSONファイル生成
4. HTMLに組み込み

**実装の工夫:**
- 問題と選択肢をJavaScriptオブジェクトとして埋め込み
- 解説文を全問題に付与
- 正解/不正解の視覚的フィードバック

### v1.15: UI改善
- ポップアップ内スクロール修正
- 確認テストボタンを最下部に移動
- チャットボタンとの配置調整

---

## v1.16: チャットボット機能（第1段階）

### 実装内容
- UI実装完了
  - 右下に常駐する紫色のボタン
  - チャット画面（380×500px）
  - メッセージ履歴表示
  - 入力欄 + 送信ボタン
  - 会話リセット機能

- フロントエンド機能
  - localStorageに会話履歴保存
  - システムプロンプト生成関数
  - Claude API呼び出し（試験版）

### 発見された問題
- **セキュリティ問題**: フロントエンドから直接Claude APIを呼ぶとAPIキーが露出
- **ネットワーク制約**: ローカルファイル（file://）ではfetchが制限される

### 解決方針
バックエンドAPI経由での実装に変更
→ v1.17で実装予定

---

## v1.17: チャットボット機能（第2段階） - 予定

### 実装予定
- バックエンドAPI作成（`/api/chat.js`）
  - Vercel Serverless Functions使用
  - Claude API呼び出し
  - 環境変数でAPIキー管理
  
- フロントエンド修正
  - APIエンドポイントを `/api/chat` に変更
  - リクエストボディに `progress` と `quizResults` を追加

- デプロイ環境構築
  - Vercelへのデプロイ
  - 環境変数設定
  - 動作確認

---

## 技術的な学び

### データ統合
- LOD（Linked Open Data）の活用
- 複数データソースの統合
- JSON構造の設計

### フロントエンド開発
- React Hooks（useState、useEffect）の活用
- localStorage永続化
- CDN版React/TailwindCSSの使用

### API統合
- NHK for School API連携
- Claude API活用
- エラーハンドリング

### セキュリティ
- APIキーの適切な管理
- バックエンドAPI経由の実装
- 環境変数の活用

---

## 今後の展開

### 短期（v1.17-v1.20）
- チャットボット完全実装
- パフォーマンス最適化
- バグ修正

### 中期（v2.0以降）
- 学習履歴の可視化
- 推奨学習順序の自動生成
- 保護者向けダッシュボード

### 長期
- 他教科への展開
- モバイルアプリ化
- 協働学習機能

---

## 参考リソース

- 教科書LOD: https://jp-textbook.github.io/
- 学習指導要領LOD: https://jp-cos.github.io/
- NHK for School API: https://school-api-portal.nhk.or.jp/
- Anthropic Claude API: https://docs.anthropic.com/
- Vercel: https://vercel.com/docs
